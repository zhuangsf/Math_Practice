# 小学数学四则运算出题工具 - 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 产品名称
小学数学四则运算出题工具

### 1.2 产品目标
为小学生提供自动化的四则运算题目生成工具，帮助学生快速进行数学练习。

### 1.3 目标用户
- 小学生（主要用户）
- 小学数学老师
- 家长

---

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 运算类型选择（多选）
- [ ] 加法运算
- [ ] 减法运算
- [ ] 乘法运算
- [ ] 除法运算
- 支持多选，可选择一种或多种运算类型组合
- 至少选择一种运算类型才能生成题目

#### 2.1.2 运算元数量选择（单选）
- [ ] 二元运算（2个数字，1个运算符，如：3 + 5）
- [ ] 三元运算（3个数字，2个运算符，如：3 + 5 - 2）
- [ ] 四元运算（4个数字，3个运算符，如：3 + 5 - 2 × 4）
- 单选，只能选择一种运算元数量

#### 2.1.3 题目生成
- 根据选择的运算类型和运算元数量生成题目
- 题目数量可配置（默认20题，可调整20，50，100题）
- 一键生成题目
- 自动计算答案

#### 2.1.4 题目显示
- 清晰展示题目
- 显示题目序号
- 显示运算表达式
- 显示标准答案（可隐藏/显示切换）

#### 2.1.5 答题模式（新增）
- [ ] **模式切换**：支持"练习模式"和"答题模式"两种模式
  - 练习模式：仅显示题目，用于打印或导出练习
  - 答题模式：可在题目下方输入答案，支持在线答题
- [ ] **答案输入**：
  - 每个题目下方提供答案输入框
  - 支持数字输入（整数）
  - 输入框支持键盘输入和鼠标点击
  - 支持Tab键快速切换输入框
  - 输入框实时验证格式（仅允许数字）
- [ ] **答题提交**：
  - 支持逐题提交（输入后立即验证）
  - 支持批量提交（完成所有题目后统一提交）
  - 提交后显示答题结果（正确/错误）
  - 支持重新答题（清空答案重新开始）
- [ ] **答题状态显示**：
  - 未答题：输入框为空，显示提示
  - 已答题未提交：输入框有值，显示待提交状态
  - 已提交正确：显示绿色对勾，答案正确
  - 已提交错误：显示红色叉号，显示正确答案

#### 2.1.6 评分系统（新增）
- [ ] **自动评分**：
  - 提交答案后自动计算得分
  - 显示得分格式：正确数/总题数（如：18/20）
  - 显示正确率百分比（如：90%）
  - 显示等级评价：
    - 优秀：≥90%
    - 良好：80%-89%
    - 及格：60%-79%
    - 需努力：<60%
- [ ] **答题统计**：
  - 显示答题用时（从开始答题到提交的时间）
  - 显示平均每题用时
  - 显示最快答题题目和最慢答题题目
- [ ] **成绩展示**：
  - 以卡片形式展示成绩概览
  - 使用图表展示得分情况（可选）
  - 支持成绩导出（记录到本地）

#### 2.1.7 错题分析（新增）
- [ ] **错题记录**：
  - 自动记录所有错题
  - 记录错题的完整信息（题目、学生答案、正确答案）
  - 记录错题时间戳
- [ ] **错题分类统计**：
  - 按运算类型统计错题数量（加法、减法、乘法、除法）
  - 按运算元数量统计错题数量（二元、三元、四元）
  - 按难度级别统计错题分布
  - 显示错题类型占比图表
- [ ] **错题详情分析**：
  - 显示每道错题的详细信息
  - 分析错误原因（计算错误、符号错误、运算顺序错误等）
  - 显示错题的运算类型和难度级别
  - 支持查看错题的标准答案和解题步骤

#### 2.1.8 个性化辅导计划（新增）
- [ ] **智能分析**：
  - 基于错题分析结果，识别薄弱环节
  - 分析学生在各运算类型上的掌握程度
  - 分析学生在各难度级别上的表现
- [ ] **辅导建议生成**：
  - 自动生成个性化辅导计划
  - 推荐需要加强的运算类型（如：建议加强乘法练习）
  - 推荐需要加强的难度级别（如：建议加强三元运算练习）
  - 提供具体的学习建议和练习方向
- [ ] **错题本功能**：
  - 生成错题本，包含所有错题
  - 支持错题本导出（TXT、PDF格式）
  - 支持错题本打印
  - 支持基于错题本重新生成相似题目进行练习
- [ ] **练习推荐**：
  - 根据错题分析，推荐针对性练习配置
  - 一键应用推荐配置，快速生成练习题目
  - 支持渐进式练习（从简单到复杂）

#### 2.1.9 导出功能
- 支持导出为文本文件（.txt）
- 支持导出为PDF文件
- 可选择是否包含答案
- 文件命名格式：四则运算题_YYYYMMDD_HHMMSS.txt/pdf
- [ ] **新增导出选项**：
  - 支持导出答题结果（包含学生答案和正确答案）
  - 支持导出错题本
  - 支持导出成绩报告（包含评分和错题分析）

### 2.2 辅助功能

#### 2.2.1 数值范围设置
- 可设置数字范围（默认：0-1000）
- 最小值：0
- 最大值：1000
- 除法题目保证能整除（无余数）

#### 2.2.2 打印功能
- 支持打印题目
- 支持打印答案（可选）

---

## 3. 非功能需求

### 3.1 性能要求
- 题目生成响应时间 < 1秒
- 支持100题批量生成
- 页面加载时间 < 3秒

### 3.2 兼容性
- 支持主流浏览器（Chrome、Edge、Firefox）
- 响应式设计，适配PC和平板设备

### 3.3 易用性
- 界面简洁友好，适合小学生使用
- 操作流程简单直观
- 提供操作提示

### 3.4 可靠性
- 答案计算100%准确
- 除法题目保证整除
- 不生成负数结果（针对小学低年级）

---

## 4. 用户界面设计

### 4.1 页面布局

```
┌─────────────────────────────────────────────────────┐
│              小学数学四则运算出题工具                  │
├─────────────────────────────────────────────────────┤
│                                                     │
│  【运算元数量】（单选）                                │
│  ⚪ 二元运算  ⚪ 三元运算  ⚪ 四元运算                 │
│                                                     │
│  【数值范围】                                         │
│  最小值: [0]  最大值: [1000]                         │
│                                                     │
│  【运算类型】（多选）                                  │
│  ☑ 加法  ☑ 减法  ☑ 乘法  ☑ 除法                     │
│                                                     │
│  【题目数量】                                         │
│  数量: [20] 题  （可选：20题 | 50题 | 100题）        │
│                                                     │
│  ☑ 显示答案（勾选则直接显示答案）                     │
│  ⚪ 练习模式  ⚪ 答题模式（可输入答案在线答题）         │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │            [生成题目]                         │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
├─────────────────────────────────────────────────────┤
│                                                     │
│  【答题模式下的题目显示】                              │
│  ┌──────────┬──────────┬──────────┬──────────┐      │
│  │ 第1题:   │ 第6题:   │ 第11题:  │ 第16题:  │      │
│  │ 25 + 37  │ 68 - 23  │ 15 × 6   │ 84 ÷ 7   │      │
│  │ = [___]  │ = [___]  │ = [___]  │ = [___]  │      │
│  │   ✓      │   ✗      │   ✓      │   ✓      │      │
│  │          │          │          │          │      │
│  │ 第2题:   │ 第7题:   │ 第12题:  │ 第17题:  │      │
│  │ 45 + 12  │ 90 - 35  │ 8 × 12   │ 72 ÷ 9   │      │
│  │ = [___]  │ = [___]  │ = [___]  │ = [___]  │      │
│  │   ✓      │   ✓      │   ✓      │   ✓      │      │
│  │          │          │          │          │      │
│  │   ...    │   ...    │   ...    │   ...    │      │
│  └──────────┴──────────┴──────────┴──────────┘      │
│                                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │  [提交答案]  [重新答题]  [查看错题]           │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  【成绩展示区域】                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │  得分：18/20  (90%)  等级：优秀              │   │
│  │  答题用时：15分30秒  平均每题：46.5秒        │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  【错题分析区域】                                     │
│  ┌─────────────────────────────────────────────┐   │
│  │  错题统计：                                    │   │
│  │  运算类型：加法(0) 减法(1) 乘法(1) 除法(0)    │   │
│  │  难度级别：二元(0) 三元(1) 四元(1)           │   │
│  │                                              │   │
│  │  薄弱环节：减法和乘法运算需要加强             │   │
│  │  建议：多练习三元和四元运算                  │   │
│  └─────────────────────────────────────────────┘   │
│                                                     │
│  ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐              │
│  │导出TXT│ │导出PDF│ │  打印 │ │导出错题│            │
│  └──────┘ └──────┘ └──────┘ └──────┘              │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**说明：**
- 题目区域分为4列显示，每列显示等量的题目
- 如果题目数不是4的倍数，最后一列的题目数可能少一些
- 当"显示答案"选项勾选时，每个题目的答案会显示在"="后面
- 答案示例：`25 + 37 = 62`（显示答案模式）

### 4.2 交互流程

#### 4.2.1 基础练习流程
1. 用户选择运算类型（可多选）
2. 用户选择运算元数量（单选）
3. （可选）调整数值范围
4. （可选）调整题目数量
5. 选择"练习模式"或"答题模式"
6. 点击"生成题目"按钮
7. 系统生成并显示题目
8. 用户可以查看答案、导出或打印

#### 4.2.2 答题模式流程（新增）
1. 选择"答题模式"
2. 生成题目后，在输入框中输入答案
3. 完成所有题目后，点击"提交答案"按钮
4. 系统自动批改并显示评分结果
5. 查看错题分析和个性化辅导建议
6. 可选择"重新答题"或"查看错题"
7. 可导出错题本或成绩报告

#### 4.2.3 错题练习流程（新增）
1. 在错题分析区域点击"查看错题"
2. 系统显示所有错题列表
3. 可基于错题本重新生成相似题目
4. 可导出错题本（TXT/PDF）
5. 可打印错题本进行线下练习

---

## 5. 技术实现建议

### 5.1 技术栈
- 前端：HTML + CSS + JavaScript（或使用Vue/React框架）
- PDF导出：jsPDF库
- 题目布局：CSS Grid（4列布局）
- 纯静态页面，无需后端服务

### 5.2 题目生成逻辑

#### 5.2.1 二元运算
- 随机生成两个数字（在指定范围内）
- 随机选择一种已选运算类型
- 计算答案
- 除法特殊处理：保证能整除

#### 5.2.2 三元运算
- 随机生成三个数字
- 随机选择两种已选运算类型
- 按标准运算顺序计算答案
- 注意减法和除法的约束（避免负数、保证整除）

#### 5.2.3 四元运算
- 随机生成四个数字
- 随机选择三种已选运算类型
- 按标准运算顺序（先乘除后加减）计算答案
- 确保所有步骤的结果都符合小学数学规范

### 5.3 约束规则

#### 5.3.1 加法
- 结果不超过最大值范围

#### 5.3.2 减法
- 被减数 ≥ 减数（保证结果非负）

#### 5.3.3 乘法
- 结果不超过最大值范围

#### 5.3.4 除法
- 被除数 ≥ 除数（除数不为0）
- 保证能整除（余数为0）

---

## 6. 开发计划

### 阶段一：基础功能开发
- 页面UI设计和实现
- 运算类型选择功能
- 运算元数量选择功能
- 题目生成核心逻辑

### 阶段二：功能完善
- 数值范围设置
- 题目数量设置
- 答案显示/隐藏
- 导出TXT功能

### 阶段三：增强功能
- 导出PDF功能
- 打印功能
- 历史记录功能
- 响应式优化

### 阶段四：答题与评分功能（新增）
- 答题模式UI设计和实现
- 答案输入框组件开发
- 答案提交和验证逻辑
- 自动评分系统
- 答题统计功能

### 阶段五：错题分析与辅导（新增）
- 错题记录和存储
- 错题分类统计
- 错题分析算法
- 个性化辅导计划生成
- 错题本功能
- 练习推荐系统

---

## 7. 验收标准

### 7.1 基础功能验收
- [ ] 能够多选运算类型
- [ ] 能够单选运算元数量
- [ ] 能够正确生成二元、三元、四元运算题目
- [ ] 答案计算100%准确
- [ ] 除法题目保证整除
- [ ] 能够导出TXT文件
- [ ] 能够导出PDF文件
- [ ] 界面美观，操作流畅
- [ ] 在主流浏览器中正常运行

### 7.2 答题功能验收（新增）
- [ ] 能够切换练习模式和答题模式
- [ ] 答题模式下每个题目都有输入框
- [ ] 输入框能够正确接收数字输入
- [ ] 能够提交答案并显示批改结果
- [ ] 能够正确标识正确和错误的题目
- [ ] 支持重新答题功能

### 7.3 评分功能验收（新增）
- [ ] 能够自动计算得分和正确率
- [ ] 能够正确显示等级评价
- [ ] 能够记录和显示答题用时
- [ ] 评分结果准确无误

### 7.4 错题分析功能验收（新增）
- [ ] 能够正确记录所有错题
- [ ] 能够按运算类型统计错题
- [ ] 能够按难度级别统计错题
- [ ] 错题统计结果准确
- [ ] 错题详情显示完整

### 7.5 辅导计划功能验收（新增）
- [ ] 能够基于错题分析生成辅导建议
- [ ] 辅导建议具有针对性
- [ ] 能够生成错题本
- [ ] 能够导出错题本
- [ ] 能够基于错题本推荐练习配置

---

## 8. 风险和限制

### 8.1 风险
- 四元运算可能产生复杂的运算顺序，需要严格按照数学规则计算
- 多运算符组合可能产生边界情况，需要充分测试

### 8.2 限制
- 目前仅支持整数运算
- 暂不支持括号和小数
- 暂不支持自定义运算符优先级

---

## 9. 后续扩展方向

- 支持小数运算
- 支持括号运算
- 支持分数运算
- 添加计时功能（已完成：答题用时统计）
- 添加错题本功能（已完成）
- 支持在线提交答案并自动批改（已完成）
- 添加成绩统计和图表展示（部分完成：基础统计）
- 支持难度等级选择（简单/中等/困难）
- [ ] **新增扩展方向**：
  - 支持答题历史记录（保存多次答题记录）
  - 支持成绩趋势分析（展示学习进步曲线）
  - 支持多人对比（家长可查看多个孩子的学习情况）
  - 支持自定义评分标准
  - 支持答题提示功能（提示运算步骤）
  - 支持语音答题（语音输入答案）
  - 支持手写识别答题（手写数字识别）
  - 支持AI智能出题（根据错题自动生成相似题目）

---

---

## 10. 答题与评分功能详细设计（新增）

### 10.1 答题模式设计

#### 10.1.1 模式切换
- **练习模式**（默认）：
  - 仅显示题目，不提供输入框
  - 适合打印和导出练习
  - 可切换显示/隐藏答案
  
- **答题模式**：
  - 每个题目下方显示答案输入框
  - 输入框样式：数字输入框，宽度适中
  - 支持键盘输入和鼠标点击
  - 支持Tab键快速切换
  - 输入验证：仅允许输入整数（负数、小数、字母等自动过滤）

#### 10.1.2 答题状态管理
- **未答题状态**：
  - 输入框为空
  - 显示占位符提示："请输入答案"
  - 输入框边框为默认颜色
  
- **已输入未提交状态**：
  - 输入框有值
  - 输入框边框为蓝色（表示已输入）
  - 显示"待提交"提示
  
- **已提交正确状态**：
  - 显示绿色对勾图标（✓）
  - 输入框背景为浅绿色
  - 显示正确答案（可选）
  
- **已提交错误状态**：
  - 显示红色叉号图标（✗）
  - 输入框背景为浅红色
  - 显示学生答案和正确答案对比
  - 正确答案用绿色高亮显示

#### 10.1.3 答题提交机制
- **逐题提交模式**（可选）：
  - 输入答案后按Enter键或点击"提交"按钮
  - 立即显示该题目的正确/错误状态
  - 适合实时反馈学习
  
- **批量提交模式**（默认）：
  - 完成所有题目后，点击"提交答案"按钮
  - 一次性批改所有题目
  - 显示总体评分结果
  - 适合模拟考试场景

### 10.2 评分系统设计

#### 10.2.1 评分计算
- **得分计算**：
  - 正确题数 / 总题数
  - 显示格式：`18/20` 或 `18分/20分`
  
- **正确率计算**：
  - (正确题数 / 总题数) × 100%
  - 显示格式：`90%`
  - 保留1位小数（如：87.5%）
  
- **等级评价**：
  - 优秀：≥90%（显示绿色，图标：⭐）
  - 良好：80%-89%（显示蓝色，图标：👍）
  - 及格：60%-79%（显示橙色，图标：✓）
  - 需努力：<60%（显示红色，图标：💪）

#### 10.2.2 答题统计
- **时间统计**：
  - 开始时间：点击"生成题目"或进入答题模式的时间
  - 结束时间：点击"提交答案"的时间
  - 答题用时：结束时间 - 开始时间
  - 显示格式：`15分30秒` 或 `15:30`
  
- **平均用时**：
  - 答题用时 / 总题数
  - 显示格式：`46.5秒/题`
  
- **最快/最慢题目**：
  - 记录每道题目的答题时间（如果支持逐题提交）
  - 显示最快答题题目和最慢答题题目

### 10.3 错题分析设计

#### 10.3.1 错题数据结构
```typescript
interface WrongQuestion {
  questionId: string;           // 题目ID
  question: Question;            // 题目信息
  studentAnswer: number;        // 学生答案
  correctAnswer: number;        // 正确答案
  operationType: OperationType; // 运算类型
  operandCount: 2 | 3 | 4;     // 运算元数量
  timestamp: Date;              // 答题时间
  timeSpent?: number;           // 该题用时（秒）
}
```

#### 10.3.2 错题分类统计
- **按运算类型统计**：
  - 加法错题数、减法错题数、乘法错题数、除法错题数
  - 计算各类型错题占比
  - 显示柱状图或饼图
  
- **按运算元数量统计**：
  - 二元运算错题数、三元运算错题数、四元运算错题数
  - 计算各难度级别错题占比
  - 显示柱状图或饼图

#### 10.3.3 错题详情展示
- **错题列表**：
  - 显示所有错题的完整信息
  - 包括：题目表达式、学生答案、正确答案、运算类型、难度级别
  - 支持排序（按运算类型、按难度级别、按时间）
  
- **错题分析**：
  - 识别错误原因类型：
    - 计算错误（答案接近但不对）
    - 符号错误（加减乘除符号混淆）
    - 运算顺序错误（先乘除后加减）
    - 完全错误（答案相差很大）

### 10.4 个性化辅导计划设计

#### 10.4.1 薄弱环节识别
- **运算类型薄弱度**：
  - 计算各运算类型的错误率
  - 错误率 > 30% 视为薄弱环节
  - 错误率 > 50% 视为严重薄弱环节
  
- **难度级别薄弱度**：
  - 计算各难度级别的错误率
  - 错误率 > 30% 视为薄弱环节
  - 错误率 > 50% 视为严重薄弱环节

#### 10.4.2 辅导建议生成
- **建议模板**：
  - "您在【运算类型】方面需要加强，建议多练习相关题目"
  - "您在【难度级别】运算上错误较多，建议从简单题目开始练习"
  - "您的【运算类型】掌握较好，可以适当增加难度"
  
- **推荐练习配置**：
  - 基于薄弱环节，推荐练习配置
  - 例如：如果减法错误率高，推荐配置为：运算类型=减法，运算元数量=二元
  - 支持一键应用推荐配置

#### 10.4.3 错题本功能
- **错题本生成**：
  - 收集所有错题
  - 按运算类型或难度级别分组
  - 生成错题本文档
  
- **错题本导出**：
  - 支持导出为TXT格式
  - 支持导出为PDF格式
  - 包含题目、学生答案、正确答案、解析（可选）
  
- **基于错题本练习**：
  - 支持基于错题本重新生成相似题目
  - 相似题目保持相同的运算类型和难度级别
  - 数字可以变化，但运算结构相同

### 10.5 数据存储设计

#### 10.5.1 本地存储
- 使用 `localStorage` 存储答题记录
- 存储结构：
  ```json
  {
    "answerRecords": [
      {
        "sessionId": "session_xxx",
        "timestamp": "2026-01-26T10:30:00",
        "questions": [...],
        "answers": [...],
        "score": 18,
        "total": 20,
        "timeSpent": 930
      }
    ],
    "wrongQuestions": [...],
    "statistics": {
      "totalSessions": 10,
      "averageScore": 85.5,
      "improvementTrend": [...]
    }
  }
  ```

#### 10.5.2 数据导出
- 支持导出答题记录为JSON格式
- 支持导出成绩报告为PDF格式
- 支持导出错题本为TXT/PDF格式

---

**文档版本**: v2.0
**创建日期**: 2026-01-26
**最后更新**: 2026-01-26
**更新内容**: 新增答题、评分、错题分析和个性化辅导计划功能需求